<template>
  <div class="modal-demo">
    <div class="demo-header">
      <h2>è‡ªå®šä¹‰å†…å®¹</h2>
      <p>
        Modal ç»„ä»¶æ”¯æŒè‡ªå®šä¹‰å¤´éƒ¨ã€å†…å®¹å’Œåº•éƒ¨ï¼Œå¯ä»¥é€šè¿‡æ’æ§½æ¥å®šåˆ¶å¼¹çª—çš„å„ä¸ªéƒ¨åˆ†ï¼Œ
        ä¹Ÿå¯ä»¥æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºå¤´éƒ¨å’Œåº•éƒ¨
      </p>
    </div>

    <div class="demo-content">
      <!-- æŒ‰é’®ç»„ -->
      <div class="demo-buttons">
        <Button @click="openModal('default')">é»˜è®¤å¼¹çª—</Button>
        <Button @click="openModal('noHeader')">æ— å¤´éƒ¨å¼¹çª—</Button>
        <Button @click="openModal('noFooter')">æ— åº•éƒ¨å¼¹çª—</Button>
        <Button @click="openModal('noHeaderFooter')">æ— å¤´éƒ¨å’Œåº•éƒ¨å¼¹çª—</Button>
        <Button @click="openModal('customStyle')">è‡ªå®šä¹‰æ ·å¼å¼¹çª—</Button>
      </div>

      <!-- é»˜è®¤å¼¹çª— -->
      <Modal
        v-model:open="modalStates.default"
        size="lg"
        :closable="true"
        :maskClosable="true"
        @cancel="handleCancel('default')"
      >
        <!-- è‡ªå®šä¹‰å¤´éƒ¨ -->
        <template #header>
          <div class="custom-header">
            <div class="header-icon">ğŸ“</div>
            <div class="header-content">
              <h3>è‡ªå®šä¹‰è¡¨å•</h3>
              <p>è¯·å¡«å†™ä»¥ä¸‹è¡¨å•ä¿¡æ¯</p>
            </div>
          </div>
        </template>

        <!-- è‡ªå®šä¹‰å†…å®¹ -->
        <div class="custom-content">
          <div class="form-group">
            <label for="name">å§“å</label>
            <Input id="name" v-model="formData.name" placeholder="è¯·è¾“å…¥å§“å" />
          </div>

          <div class="form-group">
            <label for="email">é‚®ç®±</label>
            <Input
              id="email"
              v-model="formData.email"
              placeholder="è¯·è¾“å…¥é‚®ç®±"
              type="email"
            />
          </div>

          <div class="form-group">
            <label for="message">ç•™è¨€</label>
            <Textarea
              id="message"
              v-model="formData.message"
              placeholder="è¯·è¾“å…¥ç•™è¨€å†…å®¹"
              rows="4"
            />
          </div>

          <div class="form-group">
            <Checkbox v-model="formData.agree">æˆ‘åŒæ„éšç§æ”¿ç­–</Checkbox>
          </div>
        </div>

        <!-- è‡ªå®šä¹‰åº•éƒ¨ -->
        <template #footer>
          <div class="custom-footer">
            <Button @click="resetForm" type="default">é‡ç½®</Button>
            <div class="action-buttons">
              <Button @click="handleCancel('default')" type="default"
                >å–æ¶ˆ</Button
              >
              <Button
                @click="handleSubmit('default')"
                type="primary"
                :disabled="!formData.agree"
                >æäº¤</Button
              >
            </div>
          </div>
        </template>
      </Modal>

      <!-- æ— å¤´éƒ¨å¼¹çª— -->
      <Modal
        v-model:open="modalStates.noHeader"
        size="lg"
        :closable="true"
        :header="false"
        :maskClosable="true"
        @cancel="handleCancel('noHeader')"
      >
        <!-- è‡ªå®šä¹‰å†…å®¹ -->
        <div class="custom-content">
          <div class="form-group">
            <label for="name2">å§“å</label>
            <Input
              id="name2"
              v-model="formData.name"
              placeholder="è¯·è¾“å…¥å§“å"
            />
          </div>

          <div class="form-group">
            <label for="email2">é‚®ç®±</label>
            <Input
              id="email2"
              v-model="formData.email"
              placeholder="è¯·è¾“å…¥é‚®ç®±"
              type="email"
            />
          </div>

          <div class="form-group">
            <label for="message2">ç•™è¨€</label>
            <Textarea
              id="message2"
              v-model="formData.message"
              placeholder="è¯·è¾“å…¥ç•™è¨€å†…å®¹"
              rows="4"
            />
          </div>
        </div>

        <!-- è‡ªå®šä¹‰åº•éƒ¨ -->
        <template #footer>
          <div class="custom-footer">
            <Button @click="resetForm" type="default">é‡ç½®</Button>
            <div class="action-buttons">
              <Button @click="handleCancel('noHeader')" type="default"
                >å–æ¶ˆ</Button
              >
              <Button
                @click="handleSubmit('noHeader')"
                type="primary"
                :disabled="!formData.agree"
                >æäº¤</Button
              >
            </div>
          </div>
        </template>
      </Modal>

      <!-- æ— åº•éƒ¨å¼¹çª— -->
      <Modal
        v-model:open="modalStates.noFooter"
        size="lg"
        :closable="true"
        :footer="false"
        :maskClosable="true"
        @cancel="handleCancel('noFooter')"
      >
        <!-- è‡ªå®šä¹‰å¤´éƒ¨ -->
        <template #header>
          <div class="custom-header">
            <div class="header-icon">ğŸ“</div>
            <div class="header-content">
              <h3>æŸ¥çœ‹ä¿¡æ¯</h3>
              <p>è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰åº•éƒ¨çš„å¼¹çª—</p>
            </div>
          </div>
        </template>

        <!-- è‡ªå®šä¹‰å†…å®¹ -->
        <div class="custom-content">
          <div class="info-item">
            <strong>å§“å:</strong> {{ formData.name || 'æœªå¡«å†™' }}
          </div>
          <div class="info-item">
            <strong>é‚®ç®±:</strong> {{ formData.email || 'æœªå¡«å†™' }}
          </div>
          <div class="info-item">
            <strong>ç•™è¨€:</strong> {{ formData.message || 'æœªå¡«å†™' }}
          </div>
          <div class="info-item">
            <strong>éšç§æ”¿ç­–:</strong>
            {{ formData.agree ? 'å·²åŒæ„' : 'æœªåŒæ„' }}
          </div>
          <div class="mt-4">
            <Button @click="handleCancel('noFooter')" type="primary"
              >å…³é—­</Button
            >
          </div>
        </div>
      </Modal>

      <!-- æ— å¤´éƒ¨å’Œåº•éƒ¨å¼¹çª— -->
      <Modal
        v-model:open="modalStates.noHeaderFooter"
        size="md"
        :closable="true"
        :header="false"
        :footer="false"
        :maskClosable="true"
        @cancel="handleCancel('noHeaderFooter')"
      >
        <!-- è‡ªå®šä¹‰å†…å®¹ -->
        <div class="custom-content text-center">
          <div class="warning-icon">âš ï¸</div>
          <h3 class="warning-title">ç¡®è®¤æ“ä½œ</h3>
          <p class="warning-message">æ‚¨ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ</p>
          <div class="mt-4">
            <Button
              @click="handleCancel('noHeaderFooter')"
              type="default"
              class="mr-2"
              >å–æ¶ˆ</Button
            >
            <Button
              @click="handleConfirm('noHeaderFooter')"
              type="primary"
              danger
              >ç¡®è®¤</Button
            >
          </div>
        </div>
      </Modal>

      <!-- è‡ªå®šä¹‰æ ·å¼å¼¹çª— -->
      <Modal
        v-model:open="modalStates.customStyle"
        size="lg"
        :closable="true"
        :maskClosable="true"
        class="custom-style-modal"
        :content-style="computedCustomStyles"
        @cancel="handleCancel('customStyle')"
      >
        <!-- è‡ªå®šä¹‰å¤´éƒ¨ -->
        <template #header>
          <div class="custom-header fancy-header">
            <div class="header-icon">âœ¨</div>
            <div class="header-content">
              <h3>è‡ªå®šä¹‰æ ·å¼å¼¹çª—</h3>
              <p>å®æ—¶è°ƒæ•´å¼¹çª—çš„æ ·å¼</p>
            </div>
          </div>
        </template>

        <!-- è‡ªå®šä¹‰å†…å®¹ -->
        <div class="custom-content fancy-content">
          <!-- æ ·å¼è‡ªå®šä¹‰è¡¨å• -->
          <div class="style-customizer">
            <div class="form-row">
              <div class="form-group-half">
                <label>èƒŒæ™¯é¢œè‰²</label>
                <div class="color-input-group">
                  <Input
                    v-model="customStyles.backgroundColor"
                    placeholder="#b0dafe"
                  />
                </div>
              </div>
              <div class="form-group-half">
                <label>æ–‡å­—é¢œè‰²</label>
                <div class="color-input-group">
                  <Input v-model="customStyles.color" placeholder="#333333" />
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group-half">
                <label>è¾¹æ¡†é¢œè‰²</label>
                <div class="color-input-group">
                  <Input
                    v-model="customStyles.borderColor"
                    placeholder="#3b82f6"
                  />
                </div>
              </div>
              <div class="form-group-half">
                <label>è¾¹æ¡†å®½åº¦</label>
                <Input v-model="customStyles.borderWidth" placeholder="2px" />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group-half">
                <label>è¾¹æ¡†åŠå¾„</label>
                <Input v-model="customStyles.borderRadius" placeholder="12px" />
              </div>
              <div class="form-group-half">
                <label>é˜´å½±æ•ˆæœ</label>
                <Input
                  v-model="customStyles.boxShadow"
                  placeholder="0 10px 30px rgba(0, 0, 0, 0.15)"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- è‡ªå®šä¹‰åº•éƒ¨ -->
        <template #footer>
          <div class="custom-footer fancy-footer">
            <div class="action-buttons">
              <Button @click="resetCustomStyles" type="default"
                >é‡ç½®æ ·å¼</Button
              >
              <Button @click="handleCancel('customStyle')" type="default"
                >å…³é—­</Button
              >
              <Button @click="applyCustomStyles" type="primary"
                >åº”ç”¨æ ·å¼</Button
              >
            </div>
          </div>
        </template>
      </Modal>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, computed } from 'vue';

// æ§åˆ¶ä¸åŒå¼¹çª—çš„æ˜¾ç¤ºçŠ¶æ€
const modalStates = reactive({
  default: false,
  noHeader: false,
  noFooter: false,
  noHeaderFooter: false,
  customStyle: false,
});

// è¡¨å•æ•°æ®
const formData = reactive({
  name: '',
  email: '',
  message: '',
  agree: false,
});

// è‡ªå®šä¹‰æ ·å¼æ•°æ®
const customStyles = reactive({
  backgroundColor: '#b0dafe',
  color: '#333333',
  borderColor: '#3b82f6',
  borderRadius: '12px',
  borderWidth: '2px',
  boxShadow: '0 10px 30px rgba(0, 0, 0, 0.15)',
});

// è®¡ç®—è‡ªå®šä¹‰å¼¹çª—æ ·å¼ï¼ˆä½¿ç”¨contentStyleå±æ€§ï¼‰
const computedCustomStyles = computed(() => {
  return {
    backgroundColor: customStyles.backgroundColor,
    color: customStyles.color,
    borderColor: customStyles.borderColor,
    borderRadius: customStyles.borderRadius,
    borderWidth: customStyles.borderWidth,
    boxShadow: customStyles.boxShadow,
  };
});

// æ‰“å¼€å¼¹çª—
const openModal = type => {
  modalStates[type] = true;
};

// é‡ç½®è¡¨å•
const resetForm = () => {
  formData.name = '';
  formData.email = '';
  formData.message = '';
  formData.agree = false;
};

// æäº¤è¡¨å•
const handleSubmit = type => {
  if (type !== 'customStyle' && !formData.agree) return;

  console.log('è¡¨å•æäº¤:', formData);
  alert('æ“ä½œæˆåŠŸ!');
  modalStates[type] = false;
};

// ç¡®è®¤æ“ä½œ
const handleConfirm = type => {
  alert('ç¡®è®¤æ“ä½œå·²æ‰§è¡Œ!');
  modalStates[type] = false;
};

// å–æ¶ˆæ“ä½œ
const handleCancel = type => {
  modalStates[type] = false;
};

// é‡ç½®è‡ªå®šä¹‰æ ·å¼
const resetCustomStyles = () => {
  Object.assign(customStyles, {
    backgroundColor: '#b0dafe',
    color: '#333333',
    borderColor: '#3b82f6',
    borderRadius: '12px',
    borderWidth: '2px',
    boxShadow: '0 10px 30px rgba(0, 0, 0, 0.15)',
  });
};

// åº”ç”¨è‡ªå®šä¹‰æ ·å¼
const applyCustomStyles = () => {
  console.log('åº”ç”¨è‡ªå®šä¹‰æ ·å¼:', customStyles);
  alert('æ ·å¼å·²åº”ç”¨!');
};
</script>

<style scoped>
.modal-demo {
  padding: 20px;
  background-color: var(--bg-card);
  border-radius: var(--radius-md);
}

.demo-header {
  margin-bottom: 24px;
}

.demo-header h2 {
  margin: 0 0 8px 0;
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
}

.demo-header p {
  margin: 0;
  color: var(--text-secondary);
  font-size: var(--font-size-sm);
}

.demo-content {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* æŒ‰é’®ç»„æ ·å¼ */
.demo-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-bottom: 20px;
}

/* è‡ªå®šä¹‰å¤´éƒ¨æ ·å¼ */
.custom-header {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 12px;
  padding: 0;
}

.header-icon {
  font-size: 24px;
  line-height: 1;
}

.header-content h3 {
  margin: 0 0 4px 0;
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
}

.header-content p {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

/* è‡ªå®šä¹‰å†…å®¹æ ·å¼ */
.custom-content {
  padding: 8px 0;
}

/* è¡¨å•ç»„æ ·å¼ */
.form-group {
  margin-bottom: 16px;
}

.form-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: var(--font-weight-medium);
  color: var(--text-primary);
  font-size: var(--font-size-sm);
}

.form-group :deep(.Input) {
  width: 100%;
}

.form-group :deep(.Textarea) {
  width: 100%;
}

/* ä¿¡æ¯é¡¹æ ·å¼ */
.info-item {
  margin-bottom: 12px;
  padding: 8px 0;
  border-bottom: 1px solid var(--border-color);
}

.info-item:last-child {
  border-bottom: none;
}

/* æ–‡æœ¬å±…ä¸­æ ·å¼ */
.text-center {
  text-align: center;
}

/* è­¦å‘Šå›¾æ ‡æ ·å¼ */
.warning-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

/* è­¦å‘Šæ ‡é¢˜æ ·å¼ */
.warning-title {
  margin: 0 0 8px 0;
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
}

/* è­¦å‘Šæ¶ˆæ¯æ ·å¼ */
.warning-message {
  margin: 0 0 16px 0;
  color: var(--text-secondary);
  font-size: var(--font-size-sm);
}

/* è‡ªå®šä¹‰åº•éƒ¨æ ·å¼ */
.custom-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}

.action-buttons {
  display: flex;
  gap: 8px;
}

/* è‡ªå®šä¹‰æ ·å¼å¼¹çª— */
:deep(.custom-style-modal .z-modal__content) {
  /* è‡ªå®šä¹‰æ ·å¼å°†é€šè¿‡contentStyleå±æ€§ç›´æ¥åº”ç”¨ */
}

/* æ ·å¼è‡ªå®šä¹‰å™¨ */
.style-customizer {
  margin-bottom: 24px;
}

.form-row {
  display: flex;
  gap: 16px;
  margin-bottom: 16px;
}

.form-group-half {
  flex: 1;
}

.color-input-group {
  display: flex;
  gap: 8px;
  align-items: center;
}

.color-picker {
  width: 40px;
  height: 40px;
  /* border: 1px solid var(--border-color); */
  border-radius: var(--radius-sm);
  cursor: pointer;
  padding: 2px;
}

/* æ ·å¼é¢„è§ˆ */
.style-preview {
  margin-top: 24px;
  padding: 20px;
  background-color: rgba(255, 255, 255, 0.8);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-color);
}

.style-preview h4 {
  margin: 0 0 12px 0;
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
}

.preview-box {
  padding: 16px;
  border-radius: var(--radius-sm);
  border: 1px dashed var(--border-color);
  background-color: var(--custom-bg-color, rgb(176, 218, 255));
  color: var(--custom-text-color, #333333);
  min-height: 100px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 12px;
}

.preview-text {
  margin: 0;
  font-size: var(--font-size-sm);
}

.preview-button {
  margin-top: 8px;
}

/* è‡ªå®šä¹‰æ ·å¼å¤´éƒ¨ */
.fancy-header {
  padding: 16px 0;
  border-bottom: 2px solid var(--primary-light);
}

/* è‡ªå®šä¹‰æ ·å¼å†…å®¹ */
.fancy-content {
  padding: 24px 0;
}

/* ç‰¹æ€§é¡¹æ ·å¼ */
.feature-item {
  display: flex;
  align-items: flex-start;
  gap: 16px;
  margin-bottom: 20px;
  padding: 16px;
  background-color: var(--bg-hover);
  border-radius: var(--radius-md);
  border-left: 4px solid var(--primary);
}

.feature-item:last-child {
  margin-bottom: 0;
}

.feature-icon {
  font-size: 32px;
  flex-shrink: 0;
}

.feature-content h4 {
  margin: 0 0 4px 0;
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
}

.feature-content p {
  margin: 0;
  color: var(--text-secondary);
  font-size: var(--font-size-sm);
}

/* è‡ªå®šä¹‰æ ·å¼åº•éƒ¨ */
.fancy-footer {
  padding: 16px 0;
  border-top: 1px solid var(--border-color);
  justify-content: flex-end;
}

/* é—´è·è¾…åŠ©ç±» */
.mt-4 {
  margin-top: 16px;
}

.mr-2 {
  margin-right: 8px;
}
</style>
